<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<!-- FontAwesome Icons -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />
<!-- Alertify CSS -->
<link href="https://cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/default.min.css" rel="stylesheet" />
<!-- Custom Barbershop CSS -->
<link href="~/css/customed.css" rel="stylesheet" />
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Alertify JS -->
<script src="https://cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>

@{
    ViewData["Title"] = "Amm Barbershop - Tempahan Dalam Talian";
}

<!-- Theme Switcher -->
<div class="theme-switcher">
    <div class="theme-option theme-bg-1 active" data-theme="theme-bg-1" style="background: linear-gradient(45deg, #667eea, #764ba2);" title="Barbershop - Blue Theme"></div>
    <div class="theme-option theme-bg-2" data-theme="theme-bg-2" style="background: linear-gradient(45deg, #56ab2f, #a8e6cf);" title="Barbershop - Green Theme"></div>
    <div class="theme-option theme-bg-3" data-theme="theme-bg-3" style="background: linear-gradient(45deg, #ff9a9e, #fecfef);" title="Barbershop - Pink Theme"></div>
    <div class="theme-option theme-bg-4" data-theme="theme-bg-4" style="background: linear-gradient(45deg, #4facfe, #00f2fe);" title="Barbershop - Cyan Theme"></div>
</div>

<!-- Hero Section -->
<div class="hero-section">
    <div class="container">
        <div class="row align-items-center min-vh-100">
            <div class="col-lg-8 mx-auto text-center">
                <div class="hero-content">
                    <h1 class="hero-title">
                        <i class="fas fa-cut me-3"></i>
                        Selamat Datang ke <span class="text-gradient">Amm Barbershop</span>
                    </h1>
                    <p class="hero-subtitle">
                        Perkhidmatan gunting rambut profesional dengan tempahan dalam talian yang mudah. 
                        Tempah janji temu anda hari ini dan nikmati pengalaman dandanan lelaki terbaik.
                    </p>
                    <div class="hero-buttons">
                        <button class="btn btn-hero-primary" id="bookNowBtn">
                            <i class="fas fa-calendar-check me-2"></i>Tempah Janji Temu
                        </button>
                        <a href="/EmployeeSetup" class="btn btn-hero-secondary">
                            <i class="fas fa-users me-2"></i>Portal Kakitangan
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Services Section -->
<section id="services" class="services-section">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-5">
                <h2 class="section-title">Perkhidmatan Kami</h2>
                <p class="section-subtitle">Perkhidmatan dandanan profesional untuk lelaki moden</p>
                <div class="services-management-btn">
                    <a href="/Services" class="btn btn-outline-primary">
                        <i class="fas fa-cog me-2"></i>Urus Perkhidmatan
                    </a>
                </div>
            </div>
        </div>
        <div class="row g-4" id="servicesContainer">
            <!-- Services will be loaded here via JavaScript -->
            <div class="col-12 text-center py-4">
                <i class="fas fa-spinner fa-spin fa-3x mb-3"></i>
                <p class="text-muted">Memuatkan perkhidmatan...</p>
            </div>
        </div>
    </div>
</section>

<!-- Today's Bookings Section -->
<section class="bookings-section">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-5">
                <h2 class="section-title">Janji Temu Hari Ini</h2>
                <p class="section-subtitle">Lihat apa yang berlaku di barbershop hari ini</p>
                <div class="date-display">
                    <i class="fas fa-calendar-day me-2"></i>
                    <span id="currentDate"></span>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-10 mx-auto">
                <div class="appointments-list-container">
                    <div class="appointments-header">
                        <div class="row align-items-center">
                            <div class="col-md-2">
                                <strong>Masa</strong>
                            </div>
                            <div class="col-md-3">
                                <strong>Pelanggan</strong>
                            </div>
                            <div class="col-md-3">
                                <strong>Perkhidmatan</strong>
                            </div>
                            <div class="col-md-2">
                                <strong>Tukang Gunting</strong>
                            </div>
                            <div class="col-md-2">
                                <strong>Status</strong>
                            </div>
                        </div>
                    </div>
                    <div id="homepageAppointmentsList" class="appointments-list">
                        <!-- Appointments will be loaded here via JavaScript -->
                        <div class="text-center text-muted py-4">
                            <i class="fas fa-spinner fa-spin fa-3x mb-3"></i>
                            <p>Memuatkan janji temu...</p>
                        </div>
                    </div>
                    <div id="homepageAppointmentsFooter" class="appointments-footer">
                        <div class="row">
                            <div class="col-12 text-center">
                                <small class="text-muted">
                                    <i class="fas fa-info-circle me-1"></i>
                                    <span id="appointmentsCount">Memuatkan...</span>
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>


<!-- Footer -->
<footer class="footer-section">
    <div class="container">
        <div class="row">
            <div class="col-md-6">
                <div class="footer-content">
                    <h5><i class="fas fa-cut me-2"></i>Amm Barbershop</h5>
                    <p>Perkhidmatan dandanan profesional dengan tempahan dalam talian yang mudah.</p>
                    <div class="contact-info">
                        <p><i class="fas fa-map-marker-alt me-2"></i>Gerai No 3, Perumahan Kos Rendah 3/4, Taman Koperasi, 27000 Jerantut, Pahang</p>
                        <p><i class="fas fa-phone me-2"></i>014-548 2024</p>
                        <p><i class="fas fa-clock me-2"></i>10am - 10pm</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                    <div class="footer-links">
                        <h6>Pautan Pantas</h6>
                        <a href="#services" class="footer-link">Perkhidmatan Kami</a>
                        <a href="/EmployeeSetup" class="footer-link">Portal Kakitangan</a>
                    </div>
            </div>
        </div>
        <div class="row mt-4">
            <div class="col-12 text-center">
                <div class="footer-bottom">
                    <p>&copy; 2025 Amm Barbershop. Hak cipta terpelihara.</p>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- Appointment Feedback Modal -->
<div id="feedbackModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999;">
    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto;">
        <!-- Modal Header -->
        <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 15px 15px 0 0; display: flex; justify-content: space-between; align-items: center;">
            <h5 style="margin: 0; font-weight: 600;">
                <i class="fas fa-star me-2"></i>Maklum Balas Janji Temu
            </h5>
            <button type="button" id="closeFeedbackModalBtn" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">&times;</button>
        </div>
        
        <!-- Modal Body -->
        <div style="padding: 30px;">
            <form id="feedbackForm">
                <input type="hidden" id="feedbackBookingId" />
                
                <!-- Rating Section -->
                <div style="margin-bottom: 25px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: 600; font-size: 16px;">Penilaian Perkhidmatan *</label>
                    <div style="display: flex; gap: 10px; justify-content: center;">
                        <input type="radio" id="rating1" name="rating" value="1" style="display: none;">
                        <label for="rating1" class="star-rating" data-rating="1">★</label>
                        <input type="radio" id="rating2" name="rating" value="2" style="display: none;">
                        <label for="rating2" class="star-rating" data-rating="2">★</label>
                        <input type="radio" id="rating3" name="rating" value="3" style="display: none;">
                        <label for="rating3" class="star-rating" data-rating="3">★</label>
                        <input type="radio" id="rating4" name="rating" value="4" style="display: none;">
                        <label for="rating4" class="star-rating" data-rating="4">★</label>
                        <input type="radio" id="rating5" name="rating" value="5" style="display: none;">
                        <label for="rating5" class="star-rating" data-rating="5">★</label>
                    </div>
                    <div id="ratingText" style="text-align: center; margin-top: 10px; color: #6c757d; font-size: 14px;"></div>
                </div>
                
                <!-- Comment Section -->
                <div style="margin-bottom: 25px;">
                    <label for="feedbackComment" style="display: block; margin-bottom: 10px; font-weight: 600; font-size: 16px;">Komen (Pilihan)</label>
                    <textarea id="feedbackComment" rows="4" placeholder="Kongsi pengalaman anda dengan perkhidmatan kami..." style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; resize: vertical; font-family: inherit;"></textarea>
                </div>
                
                <!-- Status Section -->
                <div style="margin-bottom: 25px;">
                    <label style="display: block; margin-bottom: 10px; font-weight: 600; font-size: 16px;">Status Janji Temu *</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                        <label style="display: flex; align-items: center; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
                            <input type="radio" name="status" value="Finish" style="margin-right: 8px;">
                            <span style="color: #28a745; font-weight: 500;">✓ Selesai</span>
                        </label>
                        <label style="display: flex; align-items: center; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
                            <input type="radio" name="status" value="Cancel" style="margin-right: 8px;">
                            <span style="color: #dc3545; font-weight: 500;">✗ Batal</span>
                        </label>
                        <label style="display: flex; align-items: center; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.3s ease;">
                            <input type="radio" name="status" value="Pending" style="margin-right: 8px;">
                            <span style="color: #ffc107; font-weight: 500;">⏳ Menunggu</span>
                        </label>
                    </div>
                </div>
            </form>
</div>

        <!-- Modal Footer -->
        <div style="padding: 20px; background: #f8f9fa; border-radius: 0 0 15px 15px; display: flex; justify-content: flex-end; gap: 10px;">
            <button type="button" id="cancelFeedbackBtn" style="padding: 10px 20px; background: #6c757d; color: white; border: none; border-radius: 5px; cursor: pointer;">
                <i class="fas fa-times me-2"></i>Batal
            </button>
            <button type="button" id="submitFeedbackBtn" style="padding: 10px 20px; background: #28a745; color: white; border: none; border-radius: 5px; cursor: pointer;">
                <i class="fas fa-check me-2"></i>Hantar Maklum Balas
            </button>
        </div>
    </div>
</div>

<script type="text/javascript">
    (function() {
        // Ensure jQuery is loaded before proceeding
        if (typeof $ === 'undefined') {
            console.error('jQuery is not loaded!');
            alert('jQuery failed to load. Please refresh the page.');
            return;
        }
        
        $(document).ready(function() {
        console.log('Home page loaded successfully');
        console.log('jQuery version:', $.fn.jquery);
        // Theme Switcher Functionality
        $('.theme-option').click(function() {
            console.log('Theme option clicked');
            // Remove active class from all options
            $('.theme-option').removeClass('active');
            
            // Add active class to clicked option
            $(this).addClass('active');
            
            // Get the theme class
            var themeClass = $(this).data('theme');
            console.log('Switching to theme:', themeClass);
            
            // Apply theme to body
            $('body').removeClass('theme-bg-1 theme-bg-2 theme-bg-3 theme-bg-4');
            $('body').addClass(themeClass);
            
            // Store theme preference in localStorage
            localStorage.setItem('barbershop-theme', themeClass);
        });

        // Load saved theme on page load
        var savedTheme = localStorage.getItem('barbershop-theme');
        if (savedTheme) {
            console.log('Loading saved theme:', savedTheme);
            $('body').addClass(savedTheme);
            $('.theme-option').removeClass('active');
            $('.theme-option[data-theme="' + savedTheme + '"]').addClass('active');
        } else {
            console.log('No saved theme found, using default');
        }

        // Smooth scrolling for anchor links
        $('a[href^="#"]').on('click', function(event) {
            var target = $(this.getAttribute('href'));
            if (target.length) {
                event.preventDefault();
                $('html, body').stop().animate({
                    scrollTop: target.offset().top - 100
                }, 1000);
            }
        });

        // Add scroll animations
        $(window).scroll(function() {
            $('.service-card').each(function() {
                var elementTop = $(this).offset().top;
                var elementBottom = elementTop + $(this).outerHeight();
                var viewportTop = $(window).scrollTop();
                var viewportBottom = viewportTop + $(window).height();

                if (elementBottom > viewportTop && elementTop < viewportBottom) {
                    $(this).addClass('animate-in');
                }
            });
        });

        // Button click animations
        $('.btn').click(function() {
            $(this).addClass('pulse');
            setTimeout(() => {
                $(this).removeClass('pulse');
            }, 200);
        });

        // Add scroll animations for booking cards
        $(window).scroll(function() {
            $('.booking-card').each(function() {
                var elementTop = $(this).offset().top;
                var elementBottom = elementTop + $(this).outerHeight();
                var viewportTop = $(window).scrollTop();
                var viewportBottom = viewportTop + $(window).height();

                if (elementBottom > viewportTop && elementTop < viewportBottom) {
                    $(this).addClass('animate-in');
                }
            });
        });

        // Book Now button click handler
        $('#bookNowBtn').click(function(e) {
            e.preventDefault();
            console.log('Book Now button clicked - redirecting to booking page');
            window.location.href = '/Booking';
        });

        // Display current date and day
        function displayCurrentDate() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            };
            const formattedDate = now.toLocaleDateString('en-US', options);
            $('#currentDate').text(formattedDate);
        }
        
        // Call the function when page loads
        displayCurrentDate();
        
        // Load today's appointments on page load
        loadHomepageAppointments();
        
        // Load services on page load
        loadHomepageServices();
        
        // Initialize feedback modal functionality
        initializeFeedbackModal();
        });
    })(); // End of immediately invoked function

    // Function to load today's appointments for homepage
    function loadHomepageAppointments() {
        $.ajax({
            url: '/Booking/GetTodayBookings',
            type: 'GET',
            success: function(response) {
                if (response.success) {
                    updateHomepageAppointmentsList(response.bookings);
                }
            },
            error: function(xhr, status, error) {
                console.error('Error loading homepage appointments:', error);
                $('#homepageAppointmentsList').html('<div class="text-center text-muted py-4"><i class="fas fa-exclamation-triangle fa-3x mb-3"></i><p>Ralat memuatkan janji temu</p></div>');
            }
        });
    }

    // Function to update the homepage appointments list display
    function updateHomepageAppointmentsList(bookings) {
        var appointmentsContainer = $('#homepageAppointmentsList');
        var appointmentsCount = $('#appointmentsCount');
        
        if (bookings.length === 0) {
            appointmentsContainer.html('<div class="text-center text-muted py-4"><i class="fas fa-calendar-times fa-3x mb-3"></i><p>Tiada janji temu dijadualkan untuk hari ini</p></div>');
            appointmentsCount.text('Tiada janji temu hari ini');
            return;
        }

        var html = '';
        bookings.forEach(function(booking) {
            var statusClass = booking.status === 'Disahkan' ? 'status-confirmed' : 
                             booking.status === 'Menunggu' ? 'status-pending' : 
                             booking.status === 'Finish' ? 'status-finished' : 'status-cancelled';
            
            // Convert status to Malay for display
            var statusText = booking.status === 'Disahkan' ? 'Disahkan' :
                            booking.status === 'Menunggu' ? 'Menunggu' :
                            booking.status === 'Finish' ? 'Selesai' :
                            booking.status === 'Cancel' ? 'Batal' : booking.status;
            
            // Format time for display
            var displayTime = booking.appointmentTime;
            if (booking.appointmentTime.includes(':')) {
                var timeParts = booking.appointmentTime.split(':');
                var hour = parseInt(timeParts[0]);
                var minute = timeParts[1];
                var ampm = hour >= 12 ? 'PM' : 'AM';
                var displayHour = hour > 12 ? hour - 12 : (hour === 0 ? 12 : hour);
                displayTime = displayHour + ':' + minute + ' ' + ampm;
            }
            
            html += '<div class="appointment-item">';
            html += '<div class="row align-items-center">';
            html += '<div class="col-md-2">';
            html += '<span class="appointment-time">' + displayTime + '</span>';
            html += '</div>';
            html += '<div class="col-md-3">';
            html += '<div class="customer-info">';
            html += '<strong>' + booking.customerName + '</strong>';
            html += '<small class="text-muted d-block">' + booking.customerPhone + '</small>';
            html += '</div>';
            html += '</div>';
            html += '<div class="col-md-3">';
            html += '<span class="service-name">' + booking.serviceType + '</span>';
            html += '</div>';
            html += '<div class="col-md-2">';
            html += '<span class="barber-name">' + (booking.barberName || 'Mana-mana Yang Tersedia') + '</span>';
            html += '</div>';
            html += '<div class="col-md-2">';
            html += '<span class="status-badge ' + statusClass + '">' + statusText + '</span>';
            html += '<button class="btn btn-sm btn-outline-primary mt-2" onclick="openFeedbackModal(' + booking.id + ')" style="width: 100%; font-size: 11px; padding: 4px 8px;">';
            html += '<i class="fas fa-star me-1"></i>Maklum Balas';
            html += '</button>';
            html += '</div>';
            html += '</div>';
            html += '</div>';
        });

        appointmentsContainer.html(html);
        appointmentsCount.text('Menunjukkan ' + bookings.length + ' janji temu hari ini');
    }

    // Function to refresh homepage appointments (can be called from other pages)
    function refreshHomepageAppointments() {
        loadHomepageAppointments();
    }

        // Auto-refresh appointments every 30 seconds
        setInterval(function() {
            loadHomepageAppointments();
        }, 30000);

    // Function to load services for homepage
    function loadHomepageServices() {
        $.ajax({
            url: '/Services/GetServices',
            type: 'GET',
            success: function(response) {
                if (response.success) {
                    updateHomepageServices(response.services);
                }
            },
            error: function(xhr, status, error) {
                console.error('Error loading services:', error);
                $('#servicesContainer').html('<div class="col-12 text-center py-4"><i class="fas fa-exclamation-triangle fa-3x mb-3"></i><p class="text-muted">Ralat memuatkan perkhidmatan</p></div>');
            }
        });
    }

    // Function to update the homepage services display
    function updateHomepageServices(services) {
        var servicesContainer = $('#servicesContainer');
        var activeServices = services.filter(service => service.isActive);
        
        if (activeServices.length === 0) {
            servicesContainer.html('<div class="col-12 text-center py-4"><i class="fas fa-cut fa-3x mb-3"></i><p class="text-muted">Tiada perkhidmatan tersedia</p></div>');
            return;
        }

        var html = '';
        activeServices.forEach(function(service) {
            // Get appropriate icon based on service name
            var iconClass = getServiceIcon(service.name);
            
            html += '<div class="col-md-4">';
            html += '<div class="service-card">';
            html += '<div class="service-icon">';
            html += '<i class="' + iconClass + '"></i>';
            html += '</div>';
            html += '<h4>' + service.name + '</h4>';
            html += '<p>' + (service.description || 'Perkhidmatan profesional berkualiti tinggi') + '</p>';
            html += '<div class="service-price">RM ' + parseFloat(service.price).toFixed(2) + '</div>';
            html += '</div>';
            html += '</div>';
        });

        servicesContainer.html(html);
    }

    // Function to get appropriate icon for service
    function getServiceIcon(serviceName) {
        var name = serviceName.toLowerCase();
        if (name.includes('gunting') || name.includes('rambut') || name.includes('hair')) {
            return 'fas fa-cut';
        } else if (name.includes('janggut') || name.includes('beard')) {
            return 'fas fa-user-tie';
        } else if (name.includes('lengkap') || name.includes('complete') || name.includes('full')) {
            return 'fas fa-spa';
        } else if (name.includes('facial') || name.includes('muka')) {
            return 'fas fa-hand-paper';
        } else if (name.includes('massage') || name.includes('urut')) {
            return 'fas fa-hands';
        } else {
            return 'fas fa-cut'; // Default icon
        }
    }

    // Initialize feedback modal functionality
    function initializeFeedbackModal() {
        // Modal close functionality
        $('#closeFeedbackModalBtn, #cancelFeedbackBtn').click(function() {
            $('#feedbackModal').hide();
            resetFeedbackForm();
        });

        // Close modal when clicking outside
        $('#feedbackModal').click(function(e) {
            if (e.target === this) {
                $('#feedbackModal').hide();
                resetFeedbackForm();
            }
        });

        // Submit feedback
        $('#submitFeedbackBtn').click(function() {
            submitFeedback();
        });

        // Prevent modal content clicks from closing modal
        $('#feedbackModal > div').click(function(e) {
            e.stopPropagation();
        });
    }

    // Function to initialize star rating when modal opens
    function initializeStarRating() {
        // Remove existing event handlers to prevent duplicates
        $('.star-rating').off('click');
        $('.star-rating').off('mouseenter mouseleave');
        $('input[name="status"]').off('change');
        
        // Star rating functionality
        $('.star-rating').click(function() {
            var rating = $(this).data('rating');
            console.log('Star clicked:', rating);
            $('.star-rating').removeClass('active');
            // Highlight all stars up to the clicked rating
            for (var i = 1; i <= rating; i++) {
                $('.star-rating[data-rating="' + i + '"]').addClass('active');
            }
            console.log('Active stars after click:', $('.star-rating.active').length);
            $('input[name="rating"][value="' + rating + '"]').prop('checked', true);
            updateRatingText(rating);
        });

        // Hover effects for stars
        $('.star-rating').hover(
            function() {
                var rating = $(this).data('rating');
                highlightStars(rating);
            },
            function() {
                var selectedRating = $('input[name="rating"]:checked').val();
                if (selectedRating) {
                    highlightStars(selectedRating);
                } else {
                    $('.star-rating').removeClass('active');
                }
            }
        );

        // Status selection styling
        $('input[name="status"]').change(function() {
            $('input[name="status"]').parent().css({
                'border-color': '#e9ecef',
                'background-color': 'white'
            });
            $(this).parent().css({
                'border-color': $(this).val() === 'Finish' ? '#28a745' : 
                               $(this).val() === 'Cancel' ? '#dc3545' : '#ffc107',
                'background-color': $(this).val() === 'Finish' ? '#f8fff9' : 
                                  $(this).val() === 'Cancel' ? '#fff8f8' : '#fffdf0'
            });
        });
    }

    // Function to highlight stars
    function highlightStars(rating) {
        $('.star-rating').removeClass('active');
        for (var i = 1; i <= rating; i++) {
            $('.star-rating[data-rating="' + i + '"]').addClass('active');
        }
        console.log('Highlighting stars up to rating:', rating);
    }

    // Function to update rating text
    function updateRatingText(rating) {
        var texts = {
            1: 'Sangat Tidak Memuaskan',
            2: 'Tidak Memuaskan',
            3: 'Biasa',
            4: 'Memuaskan',
            5: 'Sangat Memuaskan'
        };
        $('#ratingText').text(texts[rating]);
    }

    // Function to reset feedback form
    function resetFeedbackForm() {
        $('#feedbackForm')[0].reset();
        $('.star-rating').removeClass('active');
        $('#ratingText').text('');
        $('input[name="status"]').parent().css({
            'border-color': '#e9ecef',
            'background-color': 'white'
        });
    }

    // Function to open feedback modal
    function openFeedbackModal(bookingId) {
        $('#feedbackBookingId').val(bookingId);
        $('#feedbackModal').show();
        // Initialize star rating functionality when modal opens
        setTimeout(function() {
            initializeStarRating();
        }, 100);
    }

    // Function to submit feedback
    function submitFeedback() {
        var bookingId = $('#feedbackBookingId').val();
        var rating = $('input[name="rating"]:checked').val();
        var comment = $('#feedbackComment').val();
        var status = $('input[name="status"]:checked').val();

        // Validation
        if (!rating) {
            alertify.error('Sila pilih penilaian perkhidmatan.');
            return;
        }

        if (!status) {
            alertify.error('Sila pilih status janji temu.');
            return;
        }

        var feedbackData = {
            BookingId: parseInt(bookingId),
            Rating: parseInt(rating),
            Comment: comment,
            Status: status
        };

        // Show loading state
        $('#submitFeedbackBtn').prop('disabled', true).html('<i class="fas fa-spinner fa-spin me-2"></i>Menghantar...');

        // Submit feedback
        $.ajax({
            url: '/api/AppointmentFeedback/submit',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(feedbackData),
            success: function(response) {
                if (response.success) {
                    alertify.success('Maklum balas berjaya dihantar!');
                    $('#feedbackModal').hide();
                    resetFeedbackForm();
                    // Refresh the appointments list
                    loadHomepageAppointments();
                } else {
                    alertify.error(response.message || 'Ralat berlaku semasa menghantar maklum balas.');
                }
            },
            error: function(xhr, status, error) {
                console.error('Feedback submission failed:', error);
                alertify.error('Ralat berlaku semasa menghantar maklum balas. Sila cuba lagi.');
            },
            complete: function() {
                $('#submitFeedbackBtn').prop('disabled', false).html('<i class="fas fa-check me-2"></i>Hantar Maklum Balas');
            }
        });
    }
</script>

<style>
/* Star Rating Styles */
.star-rating {
    font-size: 30px;
    color: #ddd;
    cursor: pointer;
    transition: color 0.2s ease;
    user-select: none;
}

.star-rating:hover,
.star-rating.active {
    color: #ffc107;
}

/* Removed this rule as it was preventing proper star highlighting */

/* Feedback Modal Styles */
#feedbackModal input[type="radio"]:checked + span {
    font-weight: bold;
}

#feedbackModal label:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

/* ===========================================
   BACKGROUND IMAGE VARIABLES
   ===========================================
   To change background images, simply update the URLs below:
   
   --bg-theme-1: Mountain Sunset theme (default)
   --bg-theme-2: Forest Valley theme  
   --bg-theme-3: Pink Dawn theme
   --bg-theme-4: Ocean Breeze theme
   
   You can use any image URL (local or external)
   Example: --bg-theme-1: url('/images/my-custom-bg.jpg');
   =========================================== */
:root {
    --bg-theme-1: url('https://images.unsplash.com/photo-1585747860715-2ba37e788b70?ixlib=rb-4.0.3&auto=format&fit=crop&w=2074&q=80');
    --bg-theme-2: url('https://images.unsplash.com/photo-1441974231531-c6227db76b6e?ixlib=rb-4.0.3&auto=format&fit=crop&w=2071&q=80');
    --bg-theme-3: url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80');
    --bg-theme-4: url('https://images.unsplash.com/photo-1439066615861-d1af74d74000?ixlib=rb-4.0.3&auto=format&fit=crop&w=2073&q=80');
}

/* Hero Section */
.hero-section {
    padding: 100px 0;
    position: relative;
    overflow: hidden;
    background-image: var(--bg-theme-1);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    background-attachment: fixed;
}

.hero-section::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
    z-index: 1;
}

/* Theme-specific background images */
.theme-bg-1 .hero-section {
    background-image: var(--bg-theme-1);
}

.theme-bg-2 .hero-section {
    background-image: var(--bg-theme-2);
}

.theme-bg-3 .hero-section {
    background-image: var(--bg-theme-3);
}

.theme-bg-4 .hero-section {
    background-image: var(--bg-theme-4);
}

/* Mobile responsive adjustments */
@@media (max-width: 768px) {
    .hero-section {
        background-attachment: scroll;
        padding: 60px 0;
    }
    
    .hero-title {
        font-size: 2.5rem;
    }
    
    .hero-subtitle {
        font-size: 1.1rem;
    }
}

.hero-content {
    z-index: 2;
    position: relative;
}

.hero-title {
    font-size: 3.5rem;
    font-weight: 800;
    margin-bottom: 1.5rem;
    line-height: 1.2;
    color: #1a1a1a;
    text-shadow: 0 2px 4px rgba(255, 255, 255, 0.9);
}

.text-gradient {
    background: linear-gradient(135deg, var(--barbershop-secondary), var(--barbershop-primary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

.hero-subtitle {
    font-size: 1.25rem;
    color: #4a4a4a;
    margin-bottom: 2rem;
    line-height: 1.6;
    font-weight: 500;
    text-shadow: 0 1px 3px rgba(255, 255, 255, 0.8);
}

.hero-stats {
    display: flex;
    gap: 2rem;
    margin-bottom: 2rem;
}

.stat-item {
    text-align: center;
}

.stat-number {
    font-size: 2rem;
    font-weight: 700;
    color: var(--barbershop-primary);
    margin-bottom: 0.5rem;
}

.stat-label {
    font-size: 0.9rem;
    color: #6c757d;
    font-weight: 500;
}

.hero-buttons {
    display: flex;
    gap: 1rem;
    flex-wrap: wrap;
}

.btn-hero-primary {
    background: linear-gradient(135deg, var(--barbershop-secondary), #c0392b);
    color: white;
    padding: 15px 30px;
    border-radius: 50px;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.3s ease;
    border: none;
    box-shadow: 0 8px 25px rgba(231, 76, 60, 0.3);
}

.btn-hero-primary:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 35px rgba(231, 76, 60, 0.4);
    color: white;
}

.btn-hero-secondary {
    background: transparent;
    color: var(--barbershop-primary);
    padding: 15px 30px;
    border-radius: 50px;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.3s ease;
    border: 2px solid var(--barbershop-primary);
}

.btn-hero-secondary:hover {
    background: var(--barbershop-primary);
    color: white;
    transform: translateY(-3px);
}

.hero-image {
    position: relative;
    z-index: 1;
}

.barbershop-showcase {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2rem;
    padding: 2rem;
}

.showcase-item {
    background: white;
    padding: 2rem;
    border-radius: 20px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
}

.showcase-item:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
}

.showcase-item i {
    font-size: 3rem;
    color: var(--barbershop-primary);
    margin-bottom: 1rem;
}

.showcase-item h4 {
    font-weight: 600;
    margin-bottom: 0.5rem;
    color: #2c3e50;
}

.showcase-item p {
    color: #6c757d;
    font-size: 0.9rem;
}

/* Services Section */
.services-section {
    padding: 100px 0;
    background: #f8f9fa;
}

.services-management-btn {
    margin-top: 20px;
}

.services-management-btn .btn {
    padding: 12px 24px;
    border-radius: 25px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    transition: all 0.3s ease;
    border: 2px solid var(--barbershop-primary);
    color: var(--barbershop-primary);
    background: transparent;
}

.services-management-btn .btn:hover {
    background: var(--barbershop-primary);
    color: white;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(44, 62, 80, 0.3);
}

.section-title {
    font-size: 2.5rem;
    font-weight: 700;
    color: #2c3e50;
    margin-bottom: 1rem;
}

.section-subtitle {
    font-size: 1.1rem;
    color: #6c757d;
    max-width: 600px;
    margin: 0 auto;
}

.service-card {
    background: white;
    padding: 2.5rem;
    border-radius: 20px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    transition: all 0.3s ease;
    height: 100%;
    opacity: 0;
    transform: translateY(30px);
    position: relative;
}

.service-card.animate-in {
    opacity: 1;
    transform: translateY(0);
}

.service-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
}

.service-icon {
    width: 80px;
    height: 80px;
    background: linear-gradient(135deg, var(--barbershop-primary), var(--barbershop-secondary));
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 1.5rem;
}

.service-icon i {
    font-size: 2rem;
    color: white;
}

.service-card h4 {
    font-weight: 600;
    color: #2c3e50;
    margin-bottom: 1rem;
}

.service-card p {
    color: #6c757d;
    line-height: 1.6;
    margin-bottom: 1.5rem;
}

.service-price {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--barbershop-secondary);
    background: linear-gradient(135deg, var(--barbershop-secondary), #c0392b);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
}

/* Bookings Section */
.bookings-section {
    padding: 80px 0;
    background: #f8f9fa;
}

.date-display {
    background: linear-gradient(135deg, var(--barbershop-primary), #34495e);
    color: white;
    padding: 12px 24px;
    border-radius: 25px;
    display: inline-block;
    margin-top: 15px;
    font-weight: 600;
    font-size: 1.1rem;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

.date-display i {
    color: var(--barbershop-gold);
}

.bookings-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
    margin-top: 30px;
}

.booking-card {
    background: white;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    display: flex;
    align-items: center;
    transition: all 0.3s ease;
    border-left: 4px solid var(--barbershop-secondary);
}

.booking-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
}

.booking-time {
    font-weight: 700;
    color: var(--barbershop-primary);
    font-size: 1.2rem;
    min-width: 80px;
    margin-right: 20px;
}

.booking-details {
    flex: 1;
}

.booking-details h5 {
    margin: 0 0 5px 0;
    color: #2c3e50;
    font-weight: 600;
}

.booking-details p {
    margin: 0;
    color: #6c757d;
    font-size: 0.9rem;
}

.booking-status {
    margin-left: 15px;
}

.status-badge {
    padding: 6px 12px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-confirmed {
    background: linear-gradient(135deg, #27ae60, #2ecc71);
    color: white;
}

.status-finished {
    background: linear-gradient(135deg, #28a745, #20c997);
    color: white;
}

.status-pending {
    background: linear-gradient(135deg, #f39c12, #e67e22);
    color: white;
}


/* Footer */
.footer-section {
    background: #2c3e50;
    color: white;
    padding: 60px 0 30px;
}

.footer-content h5 {
    font-weight: 700;
    margin-bottom: 1rem;
}

.footer-content p {
    color: #bdc3c7;
    line-height: 1.6;
}

.contact-info p {
    color: #bdc3c7;
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
}

.footer-links h6 {
    color: white;
    font-weight: 600;
    margin-bottom: 1rem;
}

.footer-links {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.footer-link {
    color: #bdc3c7;
    text-decoration: none;
    transition: color 0.3s ease;
}

.footer-link:hover {
    color: white;
}

.footer-bottom {
    border-top: 1px solid #34495e;
    padding-top: 2rem;
    margin-top: 2rem;
}

.footer-bottom p {
    color: #bdc3c7;
    margin: 0;
}

/* Responsive Design */
@@media (max-width: 768px) {
    .hero-title {
        font-size: 2.5rem;
    }
    
    .hero-stats {
        flex-direction: column;
        gap: 1rem;
    }
    
    .hero-buttons {
        flex-direction: column;
        align-items: center;
    }
    
    .barbershop-showcase {
        grid-template-columns: 1fr;
        gap: 1rem;
    }
    
    .footer-links {
        justify-content: center;
        margin-top: 2rem;
    }
    
    .booking-buttons {
        flex-direction: column;
        align-items: center;
    }
    
    .footer-links {
        margin-top: 2rem;
    }
}

@@media (max-width: 576px) {
    .hero-title {
        font-size: 2rem;
    }
    
    .section-title {
        font-size: 2rem;
    }
    
    .booking-content h2 {
        font-size: 2rem;
    }
}

/* Appointments List Styles */
.appointments-list-container {
    background: white;
    border-radius: 15px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    margin-top: 30px;
}

.appointments-header {
    background: linear-gradient(135deg, var(--barbershop-primary), #34495e);
    color: white;
    padding: 20px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-size: 0.9rem;
}

.appointments-list {
    max-height: 400px;
    overflow-y: auto;
}

.appointment-item {
    padding: 15px 20px;
    border-bottom: 1px solid #f0f0f0;
    transition: all 0.3s ease;
}

.appointment-item:last-child {
    border-bottom: none;
}

.appointment-item:hover {
    background: #f8f9fa;
    transform: translateX(5px);
}

.appointment-time {
    font-weight: 700;
    color: var(--barbershop-primary);
    font-size: 1.1rem;
}

.customer-info strong {
    color: #2c3e50;
    font-size: 1rem;
}

.customer-info small {
    color: #6c757d;
    font-size: 0.85rem;
}

.service-name {
    color: #495057;
    font-weight: 500;
}

.barber-name {
    color: var(--barbershop-secondary);
    font-weight: 600;
}

.status-badge {
    padding: 4px 12px;
    border-radius: 20px;
    font-size: 0.8rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.status-confirmed {
    background: #d4edda;
    color: #155724;
}

.status-finished {
    background: #d1f2eb;
    color: #0e5a3e;
}

.status-pending {
    background: #fff3cd;
    color: #856404;
}

.status-cancelled {
    background: #f8d7da;
    color: #721c24;
}

.appointments-footer {
    background: #f8f9fa;
    padding: 15px 20px;
    border-top: 1px solid #e9ecef;
}

/* Mobile responsive for appointments list */
@@media (max-width: 768px) {
    .appointments-header {
        display: none;
    }
    
    .appointment-item .row {
        flex-direction: column;
        align-items: flex-start !important;
    }
    
    .appointment-item .col-md-2,
    .appointment-item .col-md-3 {
        width: 100%;
        margin-bottom: 8px;
    }
    
    .appointment-item .col-md-2:last-child {
        margin-bottom: 0;
    }
    
    .appointment-time {
        font-size: 1.2rem;
        color: var(--barbershop-secondary);
    }
    
    .customer-info strong {
        font-size: 1.1rem;
    }
}
</style>